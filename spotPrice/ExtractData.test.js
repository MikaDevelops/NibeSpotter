const {extractData} = require('./ExtractData.js');
const {mockData} = require('./__mocks__/mockData.js');
const {mockDataDayLightMarch} = require('./__mocks__/mockDataDayLightMarch.js');
const {mockDataDayLightOctober} = require('./__mocks__/mockDataDayLightOct.js');


test('extract data test 11th January 2023 15:00 EET', ()=> {

    let MockDate = require('mockdate');

    // 11th January 2023
    MockDate.set(1673442000000);

    let expectedData = [
        "2023-01-11T23:00:00.000Z","2023-01-12T00:00:00.000Z","19.88",
        "2023-01-12T00:00:00.000Z","2023-01-12T01:00:00.000Z","5.55",
        "2023-01-12T01:00:00.000Z","2023-01-12T02:00:00.000Z","4.69",
        "2023-01-12T02:00:00.000Z","2023-01-12T03:00:00.000Z","0.10",
        "2023-01-12T03:00:00.000Z","2023-01-12T04:00:00.000Z","2.73",
        "2023-01-12T04:00:00.000Z","2023-01-12T05:00:00.000Z","24.94",
        "2023-01-12T05:00:00.000Z","2023-01-12T06:00:00.000Z","36.01",
        "2023-01-12T06:00:00.000Z","2023-01-12T07:00:00.000Z","59.98",
        "2023-01-12T07:00:00.000Z","2023-01-12T08:00:00.000Z","65.18",
        "2023-01-12T08:00:00.000Z","2023-01-12T09:00:00.000Z","65.03",
        "2023-01-12T09:00:00.000Z","2023-01-12T10:00:00.000Z","66.30",
        "2023-01-12T10:00:00.000Z","2023-01-12T11:00:00.000Z","66.72",
        "2023-01-12T11:00:00.000Z","2023-01-12T12:00:00.000Z","66.60",
        "2023-01-12T12:00:00.000Z","2023-01-12T13:00:00.000Z","70.85",
        "2023-01-12T13:00:00.000Z","2023-01-12T14:00:00.000Z","73.76",
        "2023-01-12T14:00:00.000Z","2023-01-12T15:00:00.000Z","74.44",
        "2023-01-12T15:00:00.000Z","2023-01-12T16:00:00.000Z","74.81",
        "2023-01-12T16:00:00.000Z","2023-01-12T17:00:00.000Z","76.39",
        "2023-01-12T17:00:00.000Z","2023-01-12T18:00:00.000Z","78.65",
        "2023-01-12T18:00:00.000Z","2023-01-12T19:00:00.000Z","79.82",
        "2023-01-12T19:00:00.000Z","2023-01-12T20:00:00.000Z","74.08",
        "2023-01-12T20:00:00.000Z","2023-01-12T21:00:00.000Z","74.50",
        "2023-01-12T21:00:00.000Z","2023-01-12T22:00:00.000Z","66.84",
        "2023-01-12T22:00:00.000Z","2023-01-12T23:00:00.000Z","42.49"]

    expect (extractData(mockData)).toEqual(expectedData);

    MockDate.reset();

});


test('extract data test 26th March 2023 daylight saving kicks in', ()=> {

    let MockDate = require('mockdate');

    // 25th March 2023 14:00 EET
    MockDate.set(1679745600000);
   
    let expectedData = [
        "2023-03-25T23:00:00.000Z","2023-03-26T00:00:00.000Z","39.66",
        "2023-03-26T00:00:00.000Z","2023-03-26T01:00:00.000Z","39.23",
        "2023-03-26T01:00:00.000Z","2023-03-26T02:00:00.000Z","40.12",
        "2023-03-26T02:00:00.000Z","2023-03-26T03:00:00.000Z","40.88",
        "2023-03-26T03:00:00.000Z","2023-03-26T04:00:00.000Z","40.43",
        "2023-03-26T04:00:00.000Z","2023-03-26T05:00:00.000Z","41.00",
        "2023-03-26T05:00:00.000Z","2023-03-26T06:00:00.000Z","41.75",
        "2023-03-26T06:00:00.000Z","2023-03-26T07:00:00.000Z","43.39",
        "2023-03-26T07:00:00.000Z","2023-03-26T08:00:00.000Z","47.66",
        "2023-03-26T08:00:00.000Z","2023-03-26T09:00:00.000Z","49.62",
        "2023-03-26T09:00:00.000Z","2023-03-26T10:00:00.000Z","50.01",
        "2023-03-26T10:00:00.000Z","2023-03-26T11:00:00.000Z","46.37",
        "2023-03-26T11:00:00.000Z","2023-03-26T12:00:00.000Z","43.30",
        "2023-03-26T12:00:00.000Z","2023-03-26T13:00:00.000Z","44.25",
        "2023-03-26T13:00:00.000Z","2023-03-26T14:00:00.000Z","43.08",
        "2023-03-26T14:00:00.000Z","2023-03-26T15:00:00.000Z","48.35",
        "2023-03-26T15:00:00.000Z","2023-03-26T16:00:00.000Z","62.37",
        "2023-03-26T16:00:00.000Z","2023-03-26T17:00:00.000Z","61.98",
        "2023-03-26T17:00:00.000Z","2023-03-26T18:00:00.000Z","54.84",
        "2023-03-26T18:00:00.000Z","2023-03-26T19:00:00.000Z","45.58",
        "2023-03-26T19:00:00.000Z","2023-03-26T20:00:00.000Z","44.18",
        "2023-03-26T20:00:00.000Z","2023-03-26T21:00:00.000Z","40.87",
        "2023-03-26T21:00:00.000Z","2023-03-26T22:00:00.000Z","39.11",
    ] 

    expect (extractData(mockDataDayLightMarch)).toEqual(expectedData);


    MockDate.reset();

});

test('extract data test 28th October 2023 daylight saving kicks out', ()=> {

    let MockDate = require('mockdate');

    // 28th October 2023 14:00 EEST
    MockDate.set(1698490800000);

    let expectedData = [
        '2023-10-28T22:00:00.000Z', '2023-10-28T23:00:00.000Z', '34.33',
        '2023-10-28T23:00:00.000Z', '2023-10-29T00:00:00.000Z', '27.19',
        '2023-10-29T00:00:00.000Z', '2023-10-29T01:00:00.000Z', '25.34',
        '2023-10-29T01:00:00.000Z', '2023-10-29T02:00:00.000Z', '22.35',
        '2023-10-29T02:00:00.000Z', '2023-10-29T03:00:00.000Z', '21.15',
        '2023-10-29T03:00:00.000Z', '2023-10-29T04:00:00.000Z', '21.95',
        '2023-10-29T04:00:00.000Z', '2023-10-29T05:00:00.000Z', '22.83',
        '2023-10-29T05:00:00.000Z', '2023-10-29T06:00:00.000Z', '25.01',
        '2023-10-29T06:00:00.000Z', '2023-10-29T07:00:00.000Z', '25.54',
        '2023-10-29T07:00:00.000Z', '2023-10-29T08:00:00.000Z', '24.28',
        '2023-10-29T08:00:00.000Z', '2023-10-29T09:00:00.000Z', '23.93',
        '2023-10-29T09:00:00.000Z', '2023-10-29T10:00:00.000Z', '23.34',
        '2023-10-29T10:00:00.000Z', '2023-10-29T11:00:00.000Z', '23.70',
        '2023-10-29T11:00:00.000Z', '2023-10-29T12:00:00.000Z', '23.09',
        '2023-10-29T12:00:00.000Z', '2023-10-29T13:00:00.000Z', '22.42',
        '2023-10-29T13:00:00.000Z', '2023-10-29T14:00:00.000Z', '22.97',
        '2023-10-29T14:00:00.000Z', '2023-10-29T15:00:00.000Z', '34.25',
        '2023-10-29T15:00:00.000Z', '2023-10-29T16:00:00.000Z', '60.66',
        '2023-10-29T16:00:00.000Z', '2023-10-29T17:00:00.000Z', '65.83',
        '2023-10-29T17:00:00.000Z', '2023-10-29T18:00:00.000Z', '58.69',
        '2023-10-29T18:00:00.000Z', '2023-10-29T19:00:00.000Z', '44.11',
        '2023-10-29T19:00:00.000Z', '2023-10-29T20:00:00.000Z', '40.88',
        '2023-10-29T20:00:00.000Z', '2023-10-29T21:00:00.000Z', '34.28',
        '2023-10-29T21:00:00.000Z', '2023-10-29T22:00:00.000Z', '30.30',
        '2023-10-29T22:00:00.000Z', '2023-03-26T23:00:00.000Z', '24.59'
    ] 
    expect (extractData(mockDataDayLightOctober)).toEqual(expectedData);


    MockDate.reset();

});